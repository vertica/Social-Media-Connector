\set datafile '\''`echo $PACKAGE_SQLTEST`'/data/sample_tweets.json\''
create table tweets(created_at varchar(144), "user.name" varchar(144), "user.screen_name" varchar(144), text varchar(500), retweet_count int, "user.location" varchar(144), "coordinates.coordinates.0" numeric, "coordinates.coordinates.1" float, lang varchar(5));

copy tweets from local :datafile parser TweetParser();
 Rows Loaded 
-------------
          29
(1 row)

select created_at from tweets order by created_at;
           created_at           
--------------------------------
 Wed Jan 09 18:41:39 +0000 2013
 Wed Jan 09 18:41:39 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:40 +0000 2013
 Wed Jan 09 18:41:41 +0000 2013
 Wed Jan 09 18:41:42 +0000 2013
 
(29 rows)


select retweet_count from tweets order by created_at;
 retweet_count 
---------------
             0
            10
             0
             0
             0
             3
             0
             0
             0
             0
             0
             0
             0
             8
             0
             0
             5
             0
             0
             0
             0
             0
             0
             0
             0
             0
             0
             0              
              
(29 rows)


select "user.location" from tweets where "user.location" is not NULL AND "user.location" <> '' order by created_at;
        user.location         
------------------------------
 with Louis
 Las Vegas
 Charata-Chaco-Argentina... 
 Entre la estaca y la pared.
 Madrid/Espa√±a - Caracas/Vzla
 New Jersey
  Sophied Caentano e Channel 
 Rio de Janeiro
 Windsor, Ontario
 error 404 not found
 somewhere u not ‚ô° 
 289D6DC6
 ‰∫åÊ¨°ÂπºÂ•≥„ÅÆË∂≥„ÅÆË£è
 ekaterinburg
 San Antonio, Texas
(15 rows)


select "coordinates.coordinates.0", "coordinates.coordinates.1" from tweets where "coordinates.coordinates.0" is not NULL ORDER BY created_at;
 coordinates.coordinates.0 | coordinates.coordinates.1 
---------------------------+---------------------------
           60.603944880000000 |          56.84730296
         -98.389458540000007 |          29.51013636
(2 rows)

drop table tweets;


-- VER-27183
create table tweets(created_at varchar(144), "user.name" varchar(144), "user.screen_name" varchar(144), text varchar(500), retweet_count varchar, "user.location" varchar(144), "coordinates.coordinates.0" numeric, "coordinates.coordinates.1" float, lang varchar(5)); 

copy tweets from :datafile parser TweetParser();
 Rows Loaded 
-------------
          29
(1 row)

select retweet_count from tweets order by created_at;
 retweet_count 
---------------
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
(29 rows)

-- VER-27139
copy tweets from :datafile parser TweetParser() returnrejected;
 Rejected 
----------
        7
       31
(2 rows)

drop table tweets;

-- VER-27263
create table tweets(id varchar, created_at int, "user.name" int, "user.screen_name" int, text int, retweet_count varchar, "user.location" int, "coordinates.coordinates.0" varchar, "coordinates.coordinates.1" varchar, lang int); 

copy tweets from :datafile parser TweetParser();
 Rows Loaded 
-------------
          29
(1 row)

select * from tweets;
 id | created_at | user.name | user.screen_name | text | retweet_count | user.location | coordinates.coordinates.0 | coordinates.coordinates.1 | lang 
----+------------+-----------+------------------+------+---------------+---------------+---------------------------+---------------------------+------
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
    |            |           |                  |      |               |               |                           |                           |     
(29 rows)

drop table tweets;

-- VER-27302
create table tweets(created_at timestamp without timezone, "user.name" varchar(144), "user.screen_name" varchar(144), text varchar(500), retweet_count int, "user.location" varchar(144), "coordinates.coordinates.0" numeric, "coordinates.coordinates.1" float, lang varchar(5));

copy tweets from :datafile parser TweetParser();
 Rows Loaded 
-------------
          29
(1 row)

select * from tweets order by created_at;
     created_at      |      user.name       | user.screen_name |                                                                     text                                                                     | retweet_count |        user.location         | coordinates.coordinates.0 | coordinates.coordinates.1 | lang 
---------------------+----------------------+------------------+----------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------------------------+---------------------------+---------------------------+------
                     |                      |                  |                                                                                                                                              |               |                              |                           |                           | 
 2013-01-09 13:41:39 | I need you boo       | touchtheirhands  | http://t.co/CaG8W5lq                                                                                                                         |             0 | with Louis                   |                           |                           | und
 2013-01-09 13:41:39 | keth                 | dustineira       | @rememberdiley segui                                                                                                                         |            10 |                              |                           |                           | pt
 2013-01-09 13:41:40 | 0                    | yrydaqoxor       | http://t.co/YWAzSBVt –∏–≥—Ä–∞—Ç—å –≤ –∑–≤–µ–∑–¥–Ω—ã–µ –≤–æ–π–Ω—ã –≤–æ–π–Ω—ã –∫–ª–æ–Ω–æ–≤ –æ–Ω–ª–∞–π–Ω –±–µ—Å–ø–ª–∞—Ç–Ω–æ                                                                   |             0 |                              |                           |                           | ru
 2013-01-09 13:41:40 | Caitlin Clifford     | Caitlin_jc       | #stressed #tests #18soon                                                                                                                     |             0 |                              |                           |                           | en
 2013-01-09 13:41:40 | Faiz Aux‚Ñ¢‚ôû           | faizaux          | Dk ule lgu tulo,srabuk peruk la ak                                                                                                           |             0 |                              |                           |                           | id
 2013-01-09 13:41:40 | Jared Espiritu       | esp_jay          | @ImUhBeaner donuts it is !                                                                                                                   |             3 | Las Vegas                    |                           |                           | nl
 2013-01-09 13:41:40 | Jose.M.Fernandez     | JoseManuelWilly  | Faaaaaaaaaaaaaaaaaa                                                                                                                          |             0 | Charata-Chaco-Argentina...   |                           |                           | en
 2013-01-09 13:41:40 | Julito               | 1terrestar1      | RT @MorirporQuerer: #CosasQueOdio Que un 'Te quiero' se conteste con un 'y yo'.                                                              |             0 | Entre la estaca y la pared.  |                           |                           | es
 2013-01-09 13:41:40 | Khiana Christine     | khianachristine  | @Si_Seduisant lol I have to see you at some pointttt.                                                                                        |             0 |                              |                           |                           | en
 2013-01-09 13:41:40 | Lic√©e Fran√ßais LXII  | angelaa_reyees   | Haha, algo as√≠ @He_Lesh ntt; me desperto el Osotoniel ‚òπ *mi perro*                                                                           |             0 |                              |                           |                           | es
 2013-01-09 13:41:40 | Miguel Ferrari       | ferrarimiguel    | RT @OSWALSANTANA: @AMAZINGBARBARA¬†@bettyhass¬†@IvetteDominguez¬†@GrupoF3B¬†@ferrarimiguel¬†@tonnyvi¬† #Nominad@s Premios @udelespectaculo¬†        |             0 | Madrid/Espa√±a - Caracas/Vzla |                           |                           | id
 2013-01-09 13:41:40 | Mitz Guti√©rrez       | mitz1507         | RT @cosmoespanol: Feliz cumplea√±os 31 a #KateMiddleton, quien tuvo un alucinante 2012 y este a√±o se convertir√° en madre. ¬°Qu√© emoci√≥n! h ... |             0 |                              |                           |                           | es
 2013-01-09 13:41:40 | Natalie              | Natalie_Lavrov   | RT @maevelynchh: HAHA remember freshman year walking to the buses and @MaggieEhrola fell wearing a skirt in front of the seniors üòÇüòÇ #lov ... |             0 | New Jersey                   |                           |                           | en
 2013-01-09 13:41:40 | Sele Fernandez       | selefernandez3   | necesito hablar yayayayya con agustina                                                                                                       |             8 |                              |                           |                           | es
 2013-01-09 13:41:40 | SophiEd Is Eternal   | CoracaoSophied_  | @ThiagoDms_ Olha a DM Thi por favoor #Lan√ßamentoHenriqueRocha19deJaneiro                                                                     |             0 |  Sophied Caentano e Channel  |                           |                           | pt
 2013-01-09 13:41:40 | Thales Tardelli      | insiraumuser     | hahahahahahhahaha                                                                                                                            |             0 | Rio de Janeiro               |                           |                           | is
 2013-01-09 13:41:40 | Tim Doermer          | TimDoermer       | RT @ashlouz: Buying textbooks, sorry in advance bank account #poorstudentproblems                                                            |             5 | Windsor, Ontario             |                           |                           | en
 2013-01-09 13:41:40 | abdullah al-nijumi   | zaq98765         | RT @Sami_Alhomood: (ÿµŸàÿ±ÿ©)ÿ®ŸÇÿßŸÑÿ© ŸÅŸä ÿ≠ÿßŸäŸÑ:
ŸÖÿß ÿ£ÿ¨ŸÖŸÑ ÿ£ŸÜ ŸÜÿ™ŸÅŸÇÿØ ÿßŸÑŸÖÿ≠ÿ™ÿßÿ¨ŸäŸÜ ŸàÿßŸÑÿ∂ÿπŸÅÿßÿ°.
ÿµÿ≠ ŸÅŸä ÿßŸÑÿ≠ÿØŸäÿ´:"ÿßÿ®ÿ∫ŸàŸÜŸä ÿßŸÑÿ∂ÿπŸÅÿßÿ°ÿåŸÅÿ•ŸÜŸÖÿß ÿ™ÿ±ÿ≤ŸÇŸàŸÜ Ÿàÿ™ŸÜÿµÿ±ŸàŸÜ ÿ®ÿ∂ÿπŸÅÿßÿ¶ŸÉŸÖ" ... |             0 |                              |                           |                           | ar
 2013-01-09 13:41:40 | logynraybuck         | Logynraybuck     | I hate you #howsthatforfunny                                                                                                                 |             0 |                              |                           |                           | en
 2013-01-09 13:41:40 | oh la la bela        | whybela          | juro q to com mt medo de abrir meu ask                                                                                                       |             0 | error 404 not found          |                           |                           | pt
 2013-01-09 13:41:40 | stephania‚àû           | stephyy_trill23  | RT @ItsLifeFact: People come and go. But life is simply about seeing who cares enough to stay.                                               |             0 |                              |                           |                           | en
 2013-01-09 13:41:40 | stop tweet watchin ‚ô° | CeeCiana         | RT @BeautyyNBrains: If you can go a day without at LEAST texting me than I must not be that important.                                       |             0 | somewhere u not ‚ô°            |                           |                           | en
 2013-01-09 13:41:40 | ŸÖÿ≥ÿßÿπÿØ ÿßŸÑŸÅŸàÿØÿ±Ÿä        | flflc6           | ŸàŸÇŸÅŸÄŸÄŸÄÿ™ ŸÑÿπŸäŸÄŸÄŸÄŸàŸÜŸÉ ÿπŸÑŸÄŸÄŸâ ÿ∑ŸàŸÑ ÿ∑ŸàŸÑŸä ŸàÿØŸÇŸÄŸÄÿßÿ™ ŸÇŸÑÿ®ŸÄŸÄŸä ÿ™ŸÜÿ≠ŸÄŸÄŸÄŸÜŸä ÿ≠ÿ® ŸÑÿ±ÿ∂ÿßŸÉ                                                                            |             0 | 289D6DC6                     |                           |                           | ar
 2013-01-09 13:41:40 | ‚ñ≤Boss‚ñ≤               | CoreaElaineXOXO  | RT @tokenbiracial: I'm the friendliest anti-social person you'll ever meet.                                                                  |             0 |                              |                           |                           | en
 2013-01-09 13:41:40 | „ÅÇ„ÅπÊ∞è               | abesheeee        | „ÄêÂÆöÊúü„Äë „Éû„É≥„Ç¨Â§ßÂ•Ω„ÅçÔºÅ„ÄÄÊúÄËøë„ÅØÔºî„Ç≥„Éû„Å´„ÅØ„Åæ„Çä‰∏≠„ÄÄ„Åä„Åô„Åô„ÇÅ„ÅÇ„Å£„Åü„ÇâÊïô„Åà„Å¶„Å≠                                                                    |             0 | ‰∫åÊ¨°ÂπºÂ•≥„ÅÆË∂≥„ÅÆË£è             |                           |                           | ja
 2013-01-09 13:41:40 | „Åè„Éº„Çâ               | Kula_sky         | „ÇÑ„Çâ„Å™„Åç„ÇÉ„ÅÑ„Åã„Çì„Åì„Å®Âøò„Çå„Å®„Å£„Å¶PCËµ∑Âãï„ÄÇÈú≤È™®„Å´Âàá„Å™„ÅÑ„ÄÇ                                                                                         |             0 |                              |                           |                           | ja
 2013-01-09 13:41:41 | –°—Ç–∞—Ä—á–µ–Ω–∫–æ –í–ª–∞–¥–∏—Å–ª–∞–≤  | DjVLD            | @gordeev_slava –Ω–µ –ø—Ä–æ –Ω–µ–µ —Ä–µ—á—åüòÇ                                                                                                              |             0 | ekaterinburg                 |        60.603944880000000 |               56.84730296 | ru
 2013-01-09 13:41:42 | Queen Wizard         | kassieisawalrus  | ‚Äú@DigBickNick: Pizza‚Äù I want.                                                                                                                |             0 | San Antonio, Texas           |       -98.389458540000007 |               29.51013636 | it
(29 rows)

drop table tweets;

-- VER-27318
create table tweets(id int, id_str varchar);
copy tweets from :datafile parser TweetParser();
 Rows Loaded 
-------------
          29
(1 row)

select * from tweets where not id=id_str;
 id | id_str 
----+--------
(0 rows)

drop table tweets;

-- VER-27358
create table tweets(
id int,
created_at timestamptz,
"user.name" varchar(144),
"user.screen_name" varchar(144),
text varchar(500),
"retweeted_status.retweet_count" int,
"retweeted_status.id" int,
"retweeted_status.favorite_count" int,
"user.location" varchar(144),
"coordinates.coordinates.0" float,
"coordinates.coordinates.1" float,
"entities.hashtags.hashtags.0" VARCHAR(144),
"entities.hashtags.hashtags.1" VARCHAR(144),
"entities.0.hashtags.0" VARCHAR(144),
lang varchar(5)
); 
copy tweets from :datafile parser TweetParser();
 Rows Loaded 
-------------
          29
(1 row)

select id from tweets where not "entities.hashtags.hashtags.0" is null;
 id 
----
(0 rows)

select id from tweets where not "entities.0.hashtags.0" is null;
 id 
----
(0 rows)

drop table tweets;